<!--
  Generated template for the SettingsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

    <ion-navbar>
        <ion-title>Daten</ion-title>
    </ion-navbar>

</ion-header>

<ion-content padding>
    <ion-title>Einstellungen</ion-title>
    <ion-item>
        <ion-label>Entwicklungsmodus</ion-label>
        <ion-toggle [(ngModel)]="settingsService.ENVIRONMENT_IS_DEV" color="secondary"></ion-toggle>
    </ion-item>
    <ion-item>
        <ion-label>Backup beim Wiederherstellen</ion-label>
        <ion-toggle [(ngModel)]="settingsService.AUTOBACKUP_ON_RESTORE" color="secondary"></ion-toggle>
    </ion-item>
    <div *ngIf="settingsService.ENVIRONMENT_IS_DEV">
        <ion-item>
            <ion-label>Android Features</ion-label>
            <ion-toggle [(ngModel)]="show_android_features" color="secondary"></ion-toggle>
        </ion-item>
        <ion-item>
            <ion-label>Desktop Features</ion-label>
            <ion-toggle [(ngModel)]="show_desktop_features" color="secondary"></ion-toggle>
        </ion-item>
        <h3>Mock Data</h3>
        <ion-list>
            <button ion-button color="primary" block (click)="addMockData()">Testdaten hinzufügen</button>
            <button ion-button color="primary" block (click)="removeStudents()">Studenten Löschen</button>
            <button ion-button color="primary" block (click)="removeCourses()">Kurse Löschen</button>
        </ion-list>
        <ion-list *ngIf="show_android_features">
            <h3>Android Debug Functions</h3>
            <button ion-button color="primary" block (click)="createDirManually()">createDir</button>
            <button ion-button color="primary" block (click)="deleteDirManually()">deleteDir</button>
            <button ion-button color="primary" block (click)="checkDirManually()">checkDir</button>
            <button ion-button color="primary" block (click)="listDir()">ListDir</button>
        </ion-list>
    </div>
    <ion-list *ngIf="show_desktop_features">
        <h3>Data (Browser)</h3>
        <ion-title>Export</ion-title>
        <ion-item>
            <button ion-button color="primary" block (click)="downloadDataOnBrowser()">Daten Exportieren</button>
        </ion-item>
        <ion-title>Import</ion-title>
        <ion-item>
            <ng2-file-input [drop-text]="' '"  [extensions]="['stmb']" [invalid-file-text]="'Keine .stmb Datei ausgewählt'" [browse-text]="'Ziehe .stmb Datei oder klicke zum Auswählen'" (onAction)="onAction($event)"></ng2-file-input>
        </ion-item>
    </ion-list>
    <ion-list>
        <div *ngIf="show_android_features">
            <div *ngIf="settingsService.ENVIRONMENT_IS_DEV">
                <h3>Data (Android)</h3>
            </div>
            <br>
            <button ion-button color="primary" block (click)="openFileChooser()"><ion-icon float-left name="folder"></ion-icon>&nbsp;Backup auswählen</button>
            <br>
            <button ion-button color="primary" block (click)="makeBackup()"><ion-icon name="download"></ion-icon>&nbsp;Backup erstellen</button>
            <h4 *ngIf="filesInDir && filesInDir.length > 0">In ./StudentMgmt verfügbare Backups:</h4>
            <ion-list><br>
                <!-- <ion-title>Datenimport</ion-title>
                <ion-item>
                    <ng2-file-input [drop-text]="' '"  [extensions]="['stmb']" [invalid-file-text]="'Keine .stmb Datei ausgewählt'" [browse-text]="'Ziehe .stmb Datei oder klicke zum Auswählen'" (onAction)="onAction($event)"></ng2-file-input>
                </ion-item> -->
                <ion-item-sliding #slidingItem *ngFor="let file of filesInDir | orderBy : 'name' : true">
                    <ion-item *ngIf="file.isFile" block (click)="toastService.showToast('Links-Swipe für Optionen')">
                        <ion-icon name="document"></ion-icon>&nbsp;{{file.name}}{{file.lastModified}}
                    </ion-item>
                    <ion-item-options>
                        <button large style="width:75px;" ion-button color="danger" (click)="presentDeleteBackupOnAndroidConfirm(file);closeSlidingItem(slidingItem)">
                            <ion-icon name="trash"></ion-icon>
                        </button>
                        <button large style="width:75px;" ion-button color="primary" (click)="editFileName(file);closeSlidingItem(slidingItem)">
                            <ion-icon name="information-circle"></ion-icon>
                        </button>
                        <button large style="width:75px;" ion-button color="secondary" (click)="presentRestoreFromBackupOnAndroidConfirm(file);closeSlidingItem(slidingItem)">
                            <ion-icon name="checkmark"></ion-icon>
                        </button>
                    </ion-item-options>
                </ion-item-sliding>
            </ion-list>
        </div>
    </ion-list>
</ion-content>